---
export const prerender = false;
import { Image } from "astro:assets";
import commonStyles from "./../styles.module.css";
import styles from "./movie.module.css";
import MainCrew from "./MainCrew.astro";
import CastCard from "../Card/Card.astro";

const { data } = Astro.props;
const { details, directors, writers, stars, showMovie, showMainCrew, title, date, posterPath, mediatype } = data;
---
{
  showMovie && (
    <div class={commonStyles.container}>
      <div class={styles.movieHeader}>
        <h1>
          {title} ({new Date(date).getFullYear()})
        </h1>
        <span>
          {details?.vote_average != null
            ? Number(details.vote_average).toFixed(1)
            : "N/A"}/10
        </span>
      </div>      
      <div class={styles.movieTopDetails}>
        <div class={commonStyles.photo}>
          <Image
            alt={title}
            src={posterPath}
            width={185}
            height={278}
          />
        </div>
        {showMainCrew && (
          <MainCrew
            details={details}
            directors={directors}
            writers={writers}
            stars={stars}
            mediatype={mediatype} />
        )}
      </div>
      {
          stars.map((item: CastMember) => <CastCard result={item} category={"cast"} />)
      }
    </div>
  )
}
